diff -ru openresty-1.11.2.3.orig/bundle/nginx-1.11.2/src/event/ngx_event_openssl.c openresty-1.11.2.3/bundle/nginx-1.11.2/src/event/ngx_event_openssl.c
--- openresty-1.11.2.3.orig/bundle/nginx-1.11.2/src/event/ngx_event_openssl.c	2017-04-22 10:20:15.973316360 -0300
+++ openresty-1.11.2.3/bundle/nginx-1.11.2/src/event/ngx_event_openssl.c	2017-04-22 10:20:33.553120466 -0300
@@ -3093,7 +3093,7 @@
         goto failed;
     }
 
-    if (X509_check_host(cert, (char *) name->data, name->len, 0, NULL) != 1) {
+    if (X509_check_host(cert, (char *) name->data, name->len, X509_CHECK_FLAG_ALWAYS_CHECK_SUBJECT, NULL) != 1) {
         ngx_log_debug0(NGX_LOG_DEBUG_EVENT, c->log, 0,
                        "X509_check_host(): no match");
         goto failed;
@@ -3148,7 +3148,10 @@
                        "SSL subjectAltName: no match");
 
         GENERAL_NAMES_free(altnames);
-        goto failed;
+        /* Line below is commented in order to reproduce
+         * X509_CHECK_FLAG_ALWAYS_CHECK_SUBJECT behavior
+         */
+        //goto failed;
     }
 
     /*
Somente em openresty-1.11.2.3.orig/bundle/nginx-1.11.2/src/event: ngx_event_openssl.c.orig
